cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(i in 1:length(utypes)){
cormat[i,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[i],methods[j]],deconv_expr_COAD[,utypes[i]])
})
err[i,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[i],methods[j]] - deconv_expr_COAD[,utypes[i]])^2))
})
}
for(i in 1:length(types)){
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(i in 1:length(utypes)){
cormat[i,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[i],methods[j]],deconv_expr_COAD[,utypes[i]])
})
err[i,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[i],methods[j]] - deconv_expr_COAD[,utypes[i]])^2))
})
}
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('./%s',types[i]))
pdf(sprintf('./%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('./%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
types
for(i in 1:length(types)){
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(i in 1:length(utypes)){
cormat[i,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[i],methods[j]],deconv_expr_COAD[,utypes[i]])
})
err[i,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[i],methods[j]] - deconv_expr_COAD[,utypes[i]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('./%s',types[i]))
pdf(sprintf('./%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('./%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(i in 1:length(utypes)){
cormat[i,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[i],methods[j]],deconv_expr_COAD[,utypes[i]])
})
err[i,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[i],methods[j]] - deconv_expr_COAD[,utypes[i]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('./%s',types[i]))
pdf(sprintf('./%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('./%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
load(sprintf('rho_inf_%s.RData',types[i]))
setwd('~/R_batch2')
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(i in 1:length(utypes)){
cormat[i,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[i],methods[j]],deconv_expr_COAD[,utypes[i]])
})
err[i,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[i],methods[j]] - deconv_expr_COAD[,utypes[i]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('./%s',types[i]))
pdf(sprintf('./%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('./%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[l],methods[j]],deconv_expr_COAD[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[l],methods[j]] - deconv_expr_COAD[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('./%s',types[i]))
pdf(sprintf('./%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('./%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rho_COAD[,utypes[l],methods[j]],deconv_expr_COAD[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rho_COAD[,utypes[l],methods[j]] - deconv_expr_COAD[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('~/R_batch2/%s',types[i]))
pdf(sprintf('~/R_batch2/%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('~/R_batch2/%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
rhotemp <- get(sprintf('rho_inf_%s.RData',types[i]))
deconv_expr_temp <- get(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rhotemp[,utypes[l],methods[j]],deconv_expr_temp[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rhotemp[,utypes[l],methods[j]] - deconv_expr_temp[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('~/R_batch2/%s',types[i]))
pdf(sprintf('~/R_batch2/%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('~/R_batch2/%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
rhotemp <- get(sprintf('rho_%s.RData',types[i]))
deconv_expr_temp <- get(sprintf('deconv_expr_%s.RData',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rhotemp[,utypes[l],methods[j]],deconv_expr_temp[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rhotemp[,utypes[l],methods[j]] - deconv_expr_temp[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('~/R_batch2/%s',types[i]))
pdf(sprintf('~/R_batch2/%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('~/R_batch2/%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
rhotemp <- get(sprintf('rho_%s',types[i]))
deconv_expr_temp <- get(sprintf('deconv_expr_%s',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rhotemp[,utypes[l],methods[j]],deconv_expr_temp[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rhotemp[,utypes[l],methods[j]] - deconv_expr_temp[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('~/R_batch2/%s',types[i]))
pdf(sprintf('~/R_batch2/%s/%s-full-RMSE.pdf',types[i],types[i]),width = 15)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('~/R_batch2/%s/%s-full-correlation.pdf',types[i],types[i]),width = 15)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
sqrt(err)
err^2
for(i in 1:length(types)){
print(types[i])
load(sprintf('rho_inf_%s.RData',types[i]))
load(sprintf('deconv_expr_%s.RData',types[i]))
rhotemp <- get(sprintf('rho_%s',types[i]))
deconv_expr_temp <- get(sprintf('deconv_expr_%s',types[i]))
cormat <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(cormat) <- methods
rownames(cormat) <- utypes
methods <- c('LaplaceEM','OriEM','svr','ls','rls','qp')
utypes <- cellTypes
err <- matrix(NA,nrow = length(utypes),ncol = length(methods))
colnames(err) <- methods
rownames(err) <- utypes
for(l in 1:length(utypes)){
cormat[l,] <- sapply(1:length(methods), FUN = function(j){
cor(rhotemp[,utypes[l],methods[j]],deconv_expr_temp[,utypes[l]])
})
err[l,] <- sapply(1:length(methods), FUN = function(j){
sqrt(mean((rhotemp[,utypes[l],methods[j]] - deconv_expr_temp[,utypes[l]])^2))
})
}
print(err)
print(cormat)
if(1>0){
errtemp = err
cormattemp = cormat
fwrite(errtemp,file = sprintf('err_%s.csv',types[i]))
fwrite(cormattemp,file = sprintf('cormat_%s.csv',types[i]))
cellTypes <- rownames(errtemp)
methods <- colnames(errtemp)
dir.create(sprintf('~/R_batch2/%s',types[i]))
pdf(sprintf('~/R_batch2/%s/%s-full-RMSE.pdf',types[i],types[i]),width = 8)
tempdata <- melt(errtemp)
colnames(tempdata) <- c('cellTypes','methods','RMSE')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=RMSE))+
geom_point(data = tempdata,aes(x=methods,y=RMSE,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
pdf(sprintf('~/R_batch2/%s/%s-full-correlation.pdf',types[i],types[i]),width = 8)
tempdata <- melt(cormattemp)
colnames(tempdata) <- c('cellTypes','methods','Correlation')
newplot <- ggplot()+geom_boxplot(data = tempdata, aes(x=methods,y=Correlation))+
geom_point(data = tempdata, aes(x=methods,y=Correlation,color=cellTypes))+
theme(text = element_text(size = 16)) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
print(newplot)
dev.off()
}
}
source('~/R_batch1/plotRMSE.R')
source('~/R_batch1/plotRMSE.R')
source('~/Desktop/R_batch1/_lib.R')
package.skeleton(list = c("deconvEM","deconvEM_CV","deconvEM_laplace","deconvEM_CV_laplace"),name = 'EMeth')
setwd('~/Desktop/EMeth')
package.skeleton(list = c("deconvEM","deconvEM_CV","deconvEM_laplace","deconvEM_CV_laplace"),name = 'EMeth')
package.skeleton(list = c("dlaplace","deconvEM","deconvEM_CV","deconvEM_laplace","deconvEM_CV_laplace"),name = 'EMeth')
